---
layout: post
category : 算法
tagline: paxos
tags : [paxos,分布式一致性]
---
{% include JB/setup %}

(论文原文)[http://lamport.azurewebsites.net/pubs/paxos-simple.pdf]
paxos主要需要了解三件事
1. 保证分布式一致性的原理
2. 怎么做能实现这个原理
3. 这个做法为什么能实现这个原理

### 保证分布式一致性的原理
- 两个大于一半的集合的交集必定有交集

最后的一次决议一定要超过半数的acceptor同意才会通过。

这个时候只要没有超过半数的机器挂掉，从剩下的机器里找到记录数最高的那台机器

最高的那条记录必定是最新的决议，从而保证一致性

### 怎么做能实现这个原理

- 不考虑拜占庭问题，即消息可以不到达，可以延迟到达，但消息一定是原消息，不能经过篡改

- 因为会有延迟、不可达问题，所以提议里带有编号 [v, n] (v提议编号，n具体的值)

- 有acceptor和proposer两个角色，角色非完全独立，一台机器可能是其他一个或两个角色

- proposer要做的事

	- 提出提议，并发给所有的acceptor，检查是否收到超过半数的响应结果且是否同一个值，是的话记录该值并让所有acceptor记录该值，如果某个时间段内没有收到超过半数的回复，则提高提议的编号后重发

- acceptor要做的事

	- 必须批准收到的第一份提议
	
	- 如果收到的提议的编号小于自己身上已有的最大编号，则拒绝该提议
	
	- 自己身上有小于当前编号的提议时，则反馈自己身上的提议的值